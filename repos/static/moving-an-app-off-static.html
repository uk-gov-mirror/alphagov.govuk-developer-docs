

<!doctype html>
<html lang="en" class="govuk-template govuk-template--rebranded no-js">
  <head>
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>static: Moving an app off Static - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/repos/static/moving-an-app-off-static.html">
      <link rel="icon" sizes="48x48" href="/assets/govuk/assets/rebrand/images/favicon.ico">
      <link rel="icon" sizes="any" href="/assets/govuk/assets/rebrand/images/favicon.svg" type="image/svg+xml">
      <link rel="mask-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-mask.svg" color="#0b0c0c">
      <link rel="apple-touch-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-180.png">
      <link rel="manifest" href="/assets/govuk/assets/rebrand/manifest.json">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta name="twitter:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta name="twitter:title" content="static: Moving an app off Static - GOV.UK Developer Documentation" />
      <meta name="twitter:url" content="https://docs.publishing.service.gov.uk/repos/static/moving-an-app-off-static.html" />

      <meta property="og:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="static: Moving an app off Static" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/repos/static/moving-an-app-off-static.html" />

      <script>
  document.addEventListener('DOMContentLoaded', function () {
    var markup = `<div id="global-cookie-message" data-module="cookie-banner" data-nosnippet="" aria-label="Can we store analytics cookies on your device?" class="gem-c-cookie-banner govuk-clearfix govuk-cookie-banner js-banner-wrapper" role="region" hidden="hidden" title="Can we store analytics cookies on your device?"> <div class="govuk-cookie-banner__message govuk-width-container"> <div class="govuk-grid-row"> <div class="govuk-grid-column-two-thirds"> <h2 class="govuk-cookie-banner__heading govuk-heading-m">Can we store analytics cookies on your device?</h2> <div tabindex="-1" class="govuk-cookie-banner__content gem-c-cookie-banner__confirmation"> <div class="gem-c-cookie-banner__content"><p class='govuk-body'>We’d like to set some cookies to understand how you use this site and remember your settings.</p><p class='govuk-body'>We also use cookies set by other sites to help us deliver content from their services.</p></div> <p class="gem-c-cookie-banner__confirmation-message--accepted govuk-body" hidden data-ga4-cookie-banner data-module="ga4-link-tracker" data-ga4-track-links-only data-ga4-set-indexes data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" >You have accepted additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> <p class="gem-c-cookie-banner__confirmation-message--rejected govuk-body" hidden>You have rejected additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> </div> </div> </div> <div class="js-confirmation-buttons govuk-button-group"> <button class="gem-c-button govuk-button" type="submit" data-accept-cookies="true" data-cookie-types="all">Accept additional cookies</button> <button class="gem-c-button govuk-button" type="submit" data-reject-cookies="true">Reject additional cookies</button> <a class="govuk-link" href="/cookies.html">View cookies</a> </div> <div hidden class="js-hide-button govuk-button-group"> <button class="gem-c-cookie-banner__hide-button govuk-button" data-hide-cookie-banner="true" data-module="ga4-event-tracker" data-ga4-event="{&quot;event_name&quot;:&quot;select_content&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;action&quot;:&quot;closed&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" > Hide cookie message </button> </div> </div> </div>`;
    var banner = document.createElement('div');
    banner.innerHTML = markup;
    document.body.prepend(banner);
  })
</script>


  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <svg
          focusable="false"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 324 60"
          height="30"
          width="162"
          fill="currentcolor"
          class="govuk-header__logotype"
          aria-label="GOV.UK">
          <title>GOV.UK</title>
          <g>
            <circle cx="20" cy="17.6" r="3.7"></circle>
            <circle cx="10.2" cy="23.5" r="3.7"></circle>
            <circle cx="3.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <circle cx="43.3" cy="17.6" r="3.7"></circle>
            <circle cx="53.2" cy="23.5" r="3.7"></circle>
            <circle cx="59.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
          </g>
          <circle class="govuk-logo-dot" cx="226" cy="36" r="7.3"/>
          <path d="M93.94 41.25c.4 1.81 1.2 3.21 2.21 4.62 1 1.4 2.21 2.41 3.61 3.21s3.21 1.2 5.22 1.2 3.61-.4 4.82-1c1.4-.6 2.41-1.4 3.21-2.41.8-1 1.4-2.01 1.61-3.01s.4-2.01.4-3.01v.14h-10.86v-7.02h20.07v24.08h-8.03v-5.56c-.6.8-1.38 1.61-2.19 2.41-.8.8-1.81 1.2-2.81 1.81-1 .4-2.21.8-3.41 1.2s-2.41.4-3.81.4a18.56 18.56 0 0 1-14.65-6.63c-1.6-2.01-3.01-4.41-3.81-7.02s-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83a20.45 20.45 0 0 1 19.46-13.65c3.21 0 4.01.2 5.82.8 1.81.4 3.61 1.2 5.02 2.01 1.61.8 2.81 2.01 4.01 3.21s2.21 2.61 2.81 4.21l-7.63 4.41c-.4-1-1-1.81-1.61-2.61-.6-.8-1.4-1.4-2.21-2.01-.8-.6-1.81-1-2.81-1.4-1-.4-2.21-.4-3.61-.4-2.01 0-3.81.4-5.22 1.2-1.4.8-2.61 1.81-3.61 3.21s-1.61 2.81-2.21 4.62c-.4 1.81-.6 3.71-.6 5.42s.8 5.22.8 5.22Zm57.8-27.9c3.21 0 6.22.6 8.63 1.81 2.41 1.2 4.82 2.81 6.62 4.82S170.2 24.39 171 27s1.4 5.62 1.4 8.83-.4 6.02-1.4 8.83-2.41 5.02-4.01 7.02-4.01 3.61-6.62 4.82-5.42 1.81-8.63 1.81-6.22-.6-8.63-1.81-4.82-2.81-6.42-4.82-3.21-4.41-4.01-7.02-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83 2.41-5.02 4.01-7.02 4.01-3.61 6.42-4.82 5.42-1.81 8.63-1.81Zm0 36.73c1.81 0 3.61-.4 5.02-1s2.61-1.81 3.61-3.01 1.81-2.81 2.21-4.41c.4-1.81.8-3.61.8-5.62 0-2.21-.2-4.21-.8-6.02s-1.2-3.21-2.21-4.62c-1-1.2-2.21-2.21-3.61-3.01s-3.21-1-5.02-1-3.61.4-5.02 1c-1.4.8-2.61 1.81-3.61 3.01s-1.81 2.81-2.21 4.62c-.4 1.81-.8 3.61-.8 5.62 0 2.41.2 4.21.8 6.02.4 1.81 1.2 3.21 2.21 4.41s2.21 2.21 3.61 3.01c1.4.8 3.21 1 5.02 1Zm36.32 7.96-12.24-44.15h9.83l8.43 32.77h.4l8.23-32.77h9.83L200.3 58.04h-12.24Zm74.14-7.96c2.18 0 3.51-.6 3.51-.6 1.2-.6 2.01-1 2.81-1.81s1.4-1.81 1.81-2.81a13 13 0 0 0 .8-4.01V13.9h8.63v28.15c0 2.41-.4 4.62-1.4 6.62-.8 2.01-2.21 3.61-3.61 5.02s-3.41 2.41-5.62 3.21-4.62 1.2-7.02 1.2-5.02-.4-7.02-1.2c-2.21-.8-4.01-1.81-5.62-3.21s-2.81-3.01-3.61-5.02-1.4-4.21-1.4-6.62V13.9h8.63v26.95c0 1.61.2 3.01.8 4.01.4 1.2 1.2 2.21 2.01 2.81.8.8 1.81 1.4 2.81 1.81 0 0 1.34.6 3.51.6Zm34.22-36.18v18.92l15.65-18.92h10.82l-15.03 17.32 16.03 26.83h-10.21l-11.44-20.21-5.62 6.22v13.99h-8.83V13.9"/>
        </svg>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual.html">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/kubernetes/">Kubernetes</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/apps.html" aria-current="page">Apps</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/repos.html">Repos</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/mobile/">Mobile</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <ul>
    <li>
      <a href="/repos/static.html" rel="noopener" class="govuk-link">static</a>
    </li>
    <li>
      <ul>
            <li><a href="/repos/static/moving-an-app-off-static.html" rel="noopener" class="govuk-link">Moving an app off Static</a></li>
    <li><a href="/repos/static/slimmer_templates.html" rel="noopener" class="govuk-link">Slimmer Templates</a></li>
    <li><a href="/repos/static/test-ecommerce-changes-to-static.html" rel="noopener" class="govuk-link">test-ecommerce-changes-to-static</a></li>
    <li class="subdir__heading">architecture-decisions</li>
    <ul class="subdir__menu">
          <li><a href="/repos/static/architecture-decisions/0001-record-architecture-decisions.html" rel="noopener" class="govuk-link">1. Record architecture decisions</a></li>
    <li><a href="/repos/static/architecture-decisions/0002-add-enhanced-ecommerce.html" rel="noopener" class="govuk-link">2. Add Enhanced E-commerce plugin</a></li>

    </ul>

      </ul>
    </li>
  </ul>

              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "name": "Home",
        "@id": "http://www.dev.gov.uk/"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "name": "Apps",
        "@id": "http://www.dev.gov.uk/apps.html"
      }
    },
    {
      "@type": "ListItem",
      "position": 3,
      "item": {
        "name": "static",
        "@id": "http://www.dev.gov.uk/repos/static.html"
      }
    }
  ]
}
</script>

<nav data-module="ga4-link-tracker" aria-label="Breadcrumb" class="gem-c-breadcrumbs govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;1&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;2&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/apps.html">Apps</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;3&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/repos/static.html">static</a>
        </li>
  </ol>
</nav>
  <div class="govuk-!-font-size-16 govuk-!-margin-top-6">

  Last updated: <a href="https://github.com/alphagov/static/commit/50368608796fb5476d54cff0deafac044ed6d30e">12 Aug 2025</a>
</div>

  <h1 class="page-title">static: Moving an app off Static</h1>

  
<p>As part of the effort to retire static, the frontend apps that use it will have to be
altered so that they no longer use the slimmer gem. This means that they will have to
be responsible for their own Global and Emergency banners, and for configuring the
layout_for_public component which does the actual laying out of GOV.UK outward-facing
pages. To move an app off static, you will need to complete the following steps:</p>
<h2 id="existing-prs-you-can-copy-from">(Existing PRs you can copy from)</h2>
<ul>
<li><a href="https://github.com/alphagov/email-alert-frontend/pull/1890">Email Alert Frontend</a></li>
<li><a href="https://github.com/alphagov/feedback/pull/2108">Feedback</a></li>
</ul>
<h2 id="1-remove-slimmer-gem-and-config">1. Remove Slimmer gem and config</h2>
<ul>
<li><a href="https://github.com/alphagov/email-alert-frontend/pull/1890/commits/bd9af8d10d625a05e70082eaae98daa681015af5">example commit - email-alert-frontend</a></li>
<li><a href="https://github.com/alphagov/feedback/pull/2108/commits/e6cecdf8819367336fa311df605318516ddb4d6d">example commit - feedback</a></li>
</ul>
<p>First, remove the slimmer gem reference and rebuild the lockfile (<code>bundle install</code>). Then
search for references to slimmer. There will be at least one, in the application controller
where slimmer is included, and possibly in other controllers if they need to set slimmer_template.</p>
<p>Make a note of controllers that set a different slimmer template. They may indicate a
need either for a specialist layout, or for config variables to send to the default
application layout.</p>
<p>You may also need to remove slimmer references in test setups.</p>
<h2 id="2-update-the-application-layout-to-call-the-layout_for_public-component-directly">2. Update the application layout to call the layout_for_public component directly</h2>
<ul>
<li><a href="https://github.com/alphagov/email-alert-frontend/pull/1890/commits/3e57223d90f66e3def475a88db76eb2976fef865">example commit - email-alert-api</a></li>
<li><a href="https://github.com/alphagov/feedback/pull/2108/commits/db2e5303b41d9aefe60e71b7dc3ba5768fd4750a">example commit - feedback</a></li>
</ul>
<p>With static, app layouts are an HTML page, with a body that contains a wrapper element.
This element is replaced by slimmer with the contents of the relevant template from
static (which is in turn the body section of a layout_for_public component).</p>
<p>Since layout_for_public is itself a full HTML page, you replace the entire section
with a call to the layout_for_public component. You will need to add a <code>content_for :head</code>
block, containing the gem component stylesheets for the components used in
layout_for_public, and the call to <code>render_component_stylesheets</code>, and also
any additional head elements that were in the existing layout.</p>
<p>Your content_for: head block should also contain a meta_tag component to render the rendering_app
meta_tag (previously added by slimmer), and csp meta tags.</p>
<pre><code>&lt;%= content_for :head do %&gt;
  &lt;%= csp_meta_tag %&gt;
  &lt;%= render_component_stylesheets %&gt;
  &lt;%= render "govuk_publishing_components/components/meta_tags", {
    content_item: {
      rendering_app: "feedback",
    }
  } %&gt;
&lt;% end %&gt;

</code></pre>
<h1 id="3-update-initializers-to-ensure-that-all-components-can-be-loaded-individually">3. Update initializers to ensure that all components can be loaded individually</h1>
<p>Since the app is now not getting the default styles from static, configure the
publishing components gem to not exclude static css files.</p>
<p>in <code>config/initializers/govuk_publishing_components.rb</code>:</p>
<pre><code>GovukPublishingComponents.configure do |c|
  c.component_guide_title = "Email Alert Frontend Component Guide"
  c.application_stylesheet = "application"
  c.exclude_css_from_static = false
end
</code></pre>
<p>:large_orange_diamond: In the long run: If you are moving the last application, it's worth considering whether this should now be the default
in the component gem. If so, and that is updated, you can then remove this configuration from all apps :large_orange_diamond:</p>
<p>You will also need to make sure that the js dependencies are included in <code>application.js</code>,</p>
<pre><code>//= require govuk_publishing_components/dependencies
//= require govuk_publishing_components/components/feedback
//= require govuk_publishing_components/components/layout-super-navigation-header
</code></pre>
<p>...and that <code>application.scss</code> contains at least the component support styles:</p>
<pre><code>@import "govuk_publishing_components/govuk_frontend_support";
@import "govuk_publishing_components/component_support";
</code></pre>
<p>...at this point, the app should be rendering correctly for the most part.</p>
<h2 id="4-optional-create-a-basic-elements-bundle">4. (OPTIONAL) Create a basic elements bundle</h2>
<p>Although we get some advantage from individual component loading over h2, it's still wise at this point to provide
a bundle of CSS assets for the app that are used on all (or almost all) pages, because CSS compresses well, and
it compresses better if the file is larger to start with (a large CSS file is likely to contain a lot of identical
string ranges that can be compressed, compared to fewer in a small CSS file).</p>
<p>:large_orange_diamond: In the long run: we will eventually be able to provide a single CSS file with the extremely commonly
used css assets that's shared by all apps, like the current static CSS file, but without static. :large_orange_diamond:</p>
<p>Work out the components that are used by every (or most) pages in your app and add their stylesheets into <code>application.scss</code>,</p>
<pre><code>@import "govuk_publishing_components/components/heading";
@import "govuk_publishing_components/components/label";
@import "govuk_publishing_components/components/layout-footer";
@import "govuk_publishing_components/components/layout-for-public";
@import "govuk_publishing_components/components/layout-super-navigation-header";
...etc...
</code></pre>
<p>...then update <code>config/initializers/govuk_publishing_components.rb</code> to remove the <code>exclude_css_from_static option</code> and
replace it with a include a <code>custom_css_exclude_list</code> matching the components you added into <code>application.scss</code>:</p>
<pre><code>GovukPublishingComponents.configure do |c|
  c.component_guide_title = "Email Alert Frontend Component Guide"
  c.application_stylesheet = "application"
  c.custom_css_exclude_list = %w[
    heading
    label
    layout-footer
    layout-for-public
    layout-super-navigation-header
    ...etc...
  ]
end
</code></pre>
<p>If you didn't already have an <code>application.scss</code> for the app, remember also to add it to <code>config/initializers/dartsass.rb</code></p>
<h2 id="5-check-views-for-missing-content_for-blocks">5. Check views for missing <code>content_for</code> blocks</h2>
<p>Depending on the application, you may have <code>content_for</code> blocks that refer to the old layout. In Feedback this was views
that wanted to provide special headers. These, for instance, should now go into <code>content_for :head</code>, as mentioned
in step 2.</p>
<h2 id="6-lint-your-views">6. Lint your views</h2>
<p>One of the things slimmer does as a side-effect of how it works is to fix non-standard HTML (for instance, attributes
whose values are not wrapped in speechmarks). You'll have to make sure that your views don't have any of that
<a href="https://github.com/alphagov/feedback/pull/2108/commits/17b97bbfeecfb35c2fdde6c9913cb03b5082a02c">example</a></p>
<h2 id="7-add-specific-layouts">7. Add specific layouts</h2>
<p><a href="https://github.com/alphagov/email-alert-frontend/pull/1890/commits/0e16b0474b99e8987b16e5448d638c09f993d2bc">example commit</a></p>
<p>If in step 1 you identified controllers that were using a slimmer template other than
the default (<code>gem_layout</code>), you will now need to look at the relevant templates in static
and decide whether the template used differs enough from the base template to warrant
a separate layout. This is a judgement call - in the example above, the <code>gem_layout_account_manager</code>
template requires a lot of configuration, so it seems simplest to keep it as a separate
layout. If there's only one or two things different, possibly configuration is the way - you
can add controller helper methods for the different requirements, then set flags in the
layout component based on the return values of those methods.</p>
<p>This is subjective, but it will often be relatively obvious if a single layout would require
too much configuration / too many conditionals to be easy to work with. If in doubt, get another
developer involved.</p>
<h2 id="8-add-middleware-to-optimise-ga4-data-attributes">8. Add middleware to optimise GA4 data attributes</h2>
<p>Another thing slimmer does as a side-effect of how it works is optimise long ga4 attributes, which often contain a lot
of double-quotes, by wrapping the attributes in single quotes so that the double quotes don't need to be escaped.</p>
<p>The publishing components gem has a more focused middleware for doing this, which you'll need to add to your app.
<a href="https://github.com/alphagov/feedback/pull/2108/commits/5f95ee5e4105f92bbd09405d026641997b658b92">example commit</a></p>
<p>In <code>config/application.rb</code>, add:</p>
<pre><code>require "govuk_publishing_components/middleware/ga4_optimise" # (at the top)

module Feedback
  class Application &lt; Rails::Application
    ...etc...
    # Use the middleware to compact data-ga4-event/link attributes
    config.middleware.use GovukPublishingComponents::Middleware::Ga4Optimise
  end
end
</code></pre>
<h2 id="9-add-govuk_web_banners-support">9. Add <code>govuk_web_banners</code> support</h2>
<p><a href="https://github.com/alphagov/email-alert-frontend/pull/1890/commits/b08add52f18a609284af92acdb7b3d4b42ace549">example commit</a></p>
<p>If the app does not already include <a href="https://github.com/alphagov/govuk_web_banners">govuk_web_banners</a>
for recruitment banner support, add in the gem. You will then need to add the various
configurations for the banners.</p>
<p>To the application layout (and any special layouts you've added), add the emergency_banner
and global banner keys to the layout_for_public call:</p>
<pre><code>&lt;%= render "govuk_publishing_components/components/layout_for_public", {
      title: yield(:title),
      show_explore_header: true,
      emergency_banner: render("govuk_web_banners/emergency_banner"), &lt;- Add this
      global_banner: render("govuk_web_banners/global_banner"),       &lt;- And this
  } do %&gt;
</code></pre>
<p>These two banner partials contain their own CSS references, but they can't add their
own JS references, so you will need to add the web banner dependencies to the
application.js file:</p>
<pre><code>//= require govuk_publishing_components/components/global-banner
//= require govuk_web_banners/dependencies
</code></pre>
<p>..and a <code>config/initializers/govuk_web_banners.rb</code> config file:</p>
<pre><code>Rails.application.config.emergency_banner_redis_client = Redis.new(
  url: ENV["EMERGENCY_BANNER_REDIS_URL"],
  reconnect_attempts: [0, 0.1, 0.25],
)
</code></pre>
<p>Finally, to make sure your tests do not attempt to wait for an emergency banner, it's
recommended that you mock the redis client in your spec_helper or test_helper:</p>
<p>RSpec example:</p>
<pre><code>Rails.application.config.emergency_banner_redis_client = instance_double(Redis, hgetall: {})
</code></pre>
<h2 id="10-add-healthchecks-for-the-govuk_web_banners-redis">10. Add healthchecks for the <code>govuk_web_banners</code> redis</h2>
<p>Now that the app depends on checking the emergency banner redis, you must add health checks
to your <code>/healthcheck/ready</code> endpoint.</p>
<p>There is a predefined <a href="https://github.com/alphagov/govuk_app_config/blob/main/lib/govuk_app_config/govuk_healthcheck/emergency_banner_redis.rb#L4">healthcheck named
GovukHealthCheck::EmergencyBannerRedis</a>
in govuk_app_config which you can use for this:</p>
<pre><code>get "/healthcheck/ready", to: GovukHealthcheck.rack_response(
    GovukHealthcheck::EmergencyBannerRedis,
)
</code></pre>
<p>Finally you also need to update the kubernetes config for your application to
use <code>/healthcheck/ready</code> as a <a href="https://kubernetes.io/docs/concepts/configuration/liveness-readiness-startup-probes/#startup-probe">startup
probe</a>.</p>
<p>In <a href="https://github.com/alphagov/govuk-helm-charts/tree/main/charts/app-config">the app-config chart in
govuk-helm-charts</a>,
in <code>values-&lt;environment&gt;.yaml</code> you need to add the following snippet to your
specific applications configuration:</p>
<pre><code>kubernetesProbeEndpoints:
    startupProbe: "/healthcheck/ready"
</code></pre>
<p>For example in <a href="https://github.com/alphagov/govuk-helm-charts/pull/3406/">pull request
#3406</a> the
configuration for static, and draft-static, was updated so that the
configuration of them looked as follows:</p>
<pre><code>  - name: static
    helmValues:
      arch: arm64
      appResources:
        ...SNIP...
      ingress:
        ...SNIP...
      kubernetesProbeEndpoints:
        startupProbe: "/healthcheck/ready"
</code></pre>
<h2 id="11-configure-environment-variables">11. Configure environment variables</h2>
<p>In order for the app to see emergency banner messages, it will need to have the
<code>EMERGENCY_BANNER_REDIS_URL</code> variable set - this is done in govuk-helm-charts, eg:
<a href="https://github.com/alphagov/govuk-helm-charts/blob/main/charts/app-config/values-integration.yaml#L1138">https://github.com/alphagov/govuk-helm-charts/blob/main/charts/app-config/values-integration.yaml#L1138</a></p>

  <script>
    /*
      Manually trigger the styling of the 'current page' in the sidebar,
      as it does not happen automatically because we are still technically
      in single page mode.
    */
    (function () {
        'use strict'
        /*
          Cannot use `$(document).ready` on next line as jQuery has not loaded
          yet. But we can use jQuery in the callback.
        */
        window.addEventListener('load', function () {
            try {
                new GOVUK.Modules.InPageNavigation().start($("html"));
            }
            catch (error) {
                /* Fail without causing other JS in the page to break */
                console.log("Error calling GOVUK's InPageNavigation module", error);
            }
        })
    }());
</script>


            
          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/static/blob/main/docs/moving-an-app-off-static.md">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?body=Problem+with+%27%27+%28https%3A%2F%2Fdocs.publishing.service.gov.uk%2Frepos%2Fstatic%2Fmoving-an-app-off-static.html%29&amp;labels=bug&amp;title=Re%3A+%27%27">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <svg focusable="false" role="presentation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 60" height="30" width="32" fill="currentcolor" class="govuk-footer__crown">
    <g>
      <circle cx="20" cy="17.6" r="3.7"></circle>
      <circle cx="10.2" cy="23.5" r="3.7"></circle>
      <circle cx="3.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <circle cx="43.3" cy="17.6" r="3.7"></circle>
      <circle cx="53.2" cy="23.5" r="3.7"></circle>
      <circle cx="59.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
    </g>
  </svg>
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility.html">Accessibility</a>
            </li>
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/cookies.html">Cookies</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/govuk_frontend.js" type="module"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
